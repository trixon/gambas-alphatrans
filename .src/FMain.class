' Gambas class file

Public Sub _new()

End

Public Sub Action_Activate(key As String) As Boolean

  Select Case key
    Case "about"
      About()

    Case "close"
      CloseFile()

    Case "open"
      OpenFile()

    Case "save"
      SaveFile()

    Case "quit"
      Me.Close

    Default
      Print "Unknown action: " & key

  End Select

End

Public Sub Form_KeyPress()

  If Key.Code = Key.Esc Then
    Me.Close()
  Endif

End

Public Sub Form_Open()

  Settings.Read(Me)

End

Public Sub Form_Close()

  Settings.Write(Me)

End

Private Sub About()

  Dim hForm As New FAbout

  With hForm
    .AppAuthor = "Patrik Karlsson"
    .AppCopyright = ("Copyright Â© 2014 Patrik Karlsson")
    .AppDescription = ("iconv gui")
    .AppLogo = Picture.Load("logo.png")
  End With

  hForm.Run()

End

Private Sub CloseFile()

  Debug

End

Private Sub OpenFile()

  Debug

End

Private Sub SaveFile()

  Debug

End
